:imagesdir: ./images

== 集群管理
'''

进入集群管理页面（如下图）。在 *主机* 标签页可以看到TOS管理的集群的概况。

image::1cluster.png[scaledwidth=99%]

下面我们将主要介绍一些常见的集群管理操作。

=== 添加集群

在 *主机* 标签页，点击页面左上角的集群名（图例中为default）会出现一个下拉菜单（如下图），在这个菜单中您会看到当前的集群列表，您还可以点击蓝色的按钮 image:1add_cluster.png[width=24] 来添加一个新的集群。

image::1cluster_list.png[scaledwidth=99%]

点击后弹出如下的窗口：

image::1create_cluster_info.png[scaledwidth=99%]

创建集群首先需要填写的参数是“集群名”和“IP地址”,还需要指定集群的拥有者是“当前用户”还是其他“租户”，如果是租户的话则需要输入有效的租户名，并进行验证。

此外，您还需要指定集群的“Registry”，你可以使用默认的registry进行安装，还可以通过输入registry的地址和端口来指定已有的registry。

可选的连接方式有“ssh秘钥”和“root密码”两种。

上述参数配置完成后，可以点击“环境检查”来查看安装的环境情况，确认无误后点击“完成”开始安装。

=== 向集群中添加主机

在 *主机* 标签页，点击页面右上角的“新建”（如下图）可以向指定集群中添加一个新的主机，在弹出的窗口中输入新建主机的相关参数。

image::1create_node_info.png[scaledwidth=99%]

输入完成确认无误后点击“安装”。

=== 查看主机详情

将鼠标移到集群中的一台主机上可以看到关于这个主机的简略信息（如下图）。

.主机信息
image::1cluster_management_node_info.png[scaledwidth=99%]

点进去后可以查看到指定主机的详细情况（如下图），

.主机详情
image::1cluster_management_node_details.png[scaledwidth=99%]

上图中，可以清楚的看到页面左上第一行的当前主机中的标签，
通过点击页面右上角的搜索框打开一个下拉列表，列表中包括所有已有的标签，你可以根据需要选择添加。
或者您还可以增加新标签，通过在搜索框中按照“key=value”的格式输入标签值，其中“value”可以是任意字符串。输入后再点击“新标签”的按钮就可以生成，生成的新标签会加入已有标签列表。
在通过标签来筛选主机时，给出任意一个包含一到多个标签的组合，所有包含该标签组合的主机就会被筛选出来。

如果在当前页面有所改动（例如增加主机的标签），请先点击页面右上角的“保存”按钮后再退出。 

在主机标签下面是一个包含 *Pod* , *状态* ， *容器* ， *容器CPU* ， *容器内存* 和 *容器链接* 等信息的列表，您可以查看每一个Pod的相关情况。

在页面的最下方，还可以看到当前主机被分配到的配额优先级，以及CPU，内存，网络和存储的使用情况，包括已使用量和总量，还会有一个直观的使用率的配图。

=== 创建新用户配额

在“配额”标签页可以看到TOS中用户的资源配额（如下图），新用户需要管理员创建配额以后才可以在自己的TOS账户中安装和使用应用：

[[配额信息]]
.配额信息
image::1quota_tab.png[scaledwidth=99%]

您可以点击按钮 image:1add_priority.png[width=30] 来为当前用户添加新的优先级，同时可以配置“priority”， “cpu”， “memory”， “storage” 和 “network”等参数。

还可以点击<<配额信息>>页面右上角的“新建”来新建配额（如下图）：

image::1quota_create.png[scaledwidth=99%]

创建的Quota有两种，一是 *user(为用户创建)* ，二是 *leasee(为组创建)* ，分别需要输入“Email地址”或者“leasee名”来进行验证。

除此之外，还可以配置“priority”， “cpu”， “memory”， “storage” 和 “network”，这些参数都有默认值，例如“priority”的默认值为0，这是最低的优先级。

image::1new_priority.png[scaledwidth=99%]

参数设置完成点击“保存”后，新建优先级不仅会出现在所属的用户名中，还会出现在页面下方的优先级汇总表中（如下图）。

image::1total_priority.png[scaledwidth=99%]

您还可以点击上图中红色的“删除”按钮，来删除已有的优先级。

点击已有优先级的“priority”， “cpu”， “memory”， “storage” 和 “network”等任一参数就可以对已有的优先级进行修改（如下图）。

image::1modify_priority.png[scaledwidth=99%]

添加和设置好新用户的优先级后，该用户的配额即设置完成，该用户可以在自己的账户中添加并使用应用了。


